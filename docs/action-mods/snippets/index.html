<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.76.4" /><link rel="alternate" type="application/rss&#43;xml" href="/spotfire-mods/docs/action-mods/snippets/index.xml">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon"  href="/spotfire-mods/favicons/favicon.ico" >


<title>Snippets | Spotfire® Mods</title><meta property="og:title" content="Snippets" />
<meta property="og:description" content="Snippets showing what is possible to do with the API.
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/spotfire-mods/docs/action-mods/snippets/" />
<meta property="og:updated_time" content="2024-06-05T00:00:00+00:00" /><meta property="og:site_name" content="Spotfire® Mods" />
<meta itemprop="name" content="Snippets">
<meta itemprop="description" content="Snippets showing what is possible to do with the API.
">
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Snippets"/>
<meta name="twitter:description" content="Snippets showing what is possible to do with the API.
"/>





<link rel="preload" href="/spotfire-mods/scss/main.min.72f22e8e0ad59e83cda05666a5594340373d136102f4b18ebc46130efa7d36bc.css" as="style">
<link href="/spotfire-mods/scss/main.min.72f22e8e0ad59e83cda05666a5594340373d136102f4b18ebc46130efa7d36bc.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>




    <title>Snippets | Spotfire® Mods</title>
  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/spotfire-mods/">
		<span class="navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 232 40"><defs><style>.cls-1{fill:#333c66}.cls-1,.cls-2{stroke-width:0}.cls-2{fill:#e94165}</style></defs><g><path class="cls-1" d="m117.2 30.2h2.7c.1.0.2-.1.2-.2V16.1c0-.1-.1-.2-.2-.2h-2.6c-.1.0-.2.1-.2.2v14c-.1.1.0.1.1.1zm8.1-12.5v-1.6c0-.1-.1-.2-.2-.2h-2.6c-.1.0-.2.1-.2.2V30c0 .1.1.2.2.2h2.6c.1.0.2-.1.2-.2v-7.3c0-1.5.3-2.5.9-3.1s1.5-.9 2.7-.9h.6c.1.0.2-.1.2-.2v-2.7c0-.1-.1-.2-.2-.2-.9.0-1.7.2-2.4.6-.7.4-1.2.9-1.7 1.5.0.1-.1.0-.1.0h0zm-37.7.8c2.8.0 5 2.5 4.5 5.3-.3 1.8-1.8 3.2-3.6 3.5-3 .6-5.5-1.6-5.5-4.3.0-2.5 2.1-4.5 4.6-4.5m0-3c-4.5.0-8.1 3.8-7.6 8.3.4 3.4 3.2 6.2 6.7 6.6 4.6.5 8.5-3 8.5-7.4.0-4.1-3.4-7.4-7.6-7.5zm27.9-3.8v-2.4c0-.1-.1-.2-.2-.2-2-.1-4.1.4-5.1 1.3-1.1 1-1.6 2.4-1.6 4.4v1.1h-2.4c-.1.0-.2.1-.2.2v2.4c0 .1.1.2.2.2h2.4V30c0 .1.1.2.2.2h2.7c.1.0.2-.1.2-.2V18.7h3.6c.1.0.2-.1.2-.2v-2.4c0-.1-.1-.2-.2-.2h-3.7v-1.1c0-2 1.5-2.9 3.6-2.8.2.0.3-.1.3-.3z"/><ellipse class="cls-1" cx="118.6" cy="10.9" rx="1.9" ry="1.8"/><path class="cls-1" d="m77.9 18.8c-.7-1.1-1.6-2-2.7-2.5s-2.3-.9-3.6-.9c-.5.0-1.1.1-1.6.2-.7.1-1.4.4-2 .7-.4.2-.7.4-1 .6l-.1-.1v-1c0-.1-.1-.2-.2-.2h-2.7c-.1.0-.2.1-.2.2v19.8c0 .1.1.2.2.2h2.6c.1.0.2-.1.2-.2V28c0-.1.1-.1.1.0.5.6 1.2 1.1 2 1.5.9.5 1.9.7 3 .7h.2c1.1-.1 2.1-.4 3-.9 1.1-.6 2-1.5 2.7-2.6s1-2.5 1-4-.2-2.8-.9-3.9h0zm-6.3 8.4c-2.4.0-4.4-2-4.4-4.5s2-4.5 4.4-4.5 4.4 2 4.4 4.5-2 4.5-4.4 4.5zm-11-6.3c-.8-.9-2-1.7-3.6-2.2l-2.1-.8c-2.1-.8-3.2-1.4-3.2-2.9s1.7-2.4 3.3-2.4c1 0 1.8.2 2.6.7.7.4 1.5.4 2.2.0l1.2-.8c.3-.2.3-.3.2-.4-1.5-1.6-3.7-2.6-6.1-2.6-1.9.0-3.6.5-4.8 1.5-1.3 1-1.9 2.5-1.9 4.2.0 2.7 1.5 4.5 4.9 5.7l2.3.8c2 .7 3 1.7 3 3.1.0 1.5-1.4 2.5-3.4 2.5-1.4.0-2.7-.5-3.7-1.3-.7-.6-1.7-.6-2.4-.1l-1 .7c-.3.2-.3.4-.2.5 1.4 2.1 4.1 3.4 7.2 3.4 2 0 3.7-.5 5-1.6 1.3-1 1.9-2.5 1.9-4.2-.1-1.6-.5-2.8-1.4-3.8zm43.9-2.2c.1.0.2-.1.2-.2v-2.4c0-.1-.1-.2-.2-.2h-3.7v-3.7c0-.1-.1-.2-.2-.2H98c-.1.0-.2.1-.2.2v3.7h-2.4c-.1.0-.2.1-.2.2v2.4c0 .1.1.2.2.2h2.4v7.5c0 1.4.4 2.5 1.1 3.1s1.8 1 3.2 1h2.5c.1.0.2-.1.2-.2v-2.1c0-.1-.1-.2-.2-.2h-1.9c-.6.0-1.1-.1-1.3-.4s-.4-.6-.4-1.2v-7.5h3.5zm33.1 8.9c-1.2.0-2.2-.3-3-.9s-1.4-1.7-1.6-2.7h11.3c.1.0.2-.1.2-.2.1-.4.1-.8.1-1.1.0-1.5-.4-2.5-1.1-3.9-.2-.4-.6-.8-.9-1.2-1.4-1.5-3.1-2.2-5.2-2.2s-4.1.7-5.5 2.1-2.1 3.2-2.1 5.3.7 3.9 2.2 5.3 3.4 2.1 5.7 2.1c2.5.0 4.4-.8 5.8-2.4.1-.1.1-.2.0-.3l-.7-.6c-.7-.6-1.7-.7-2.4-.2s-1.7.9-2.8.9zm-3.2-8.4c.8-.6 1.7-.9 2.9-.9 1 0 1.9.3 2.7.9s1.2 1.2 1.4 2.3v.1h-8.5c.2-1.1.7-1.7 1.5-2.4h0z"/></g><path class="cls-1" d="m146.4 13.4v.4h-.6v1.7h-.4v-1.7h-.6v-.4h1.6zm2 0h.4v2.1h-.4v-1.4l-.6 1-.6-1v1.4h-.4v-2.1h.4l.7 1.1.5-1.1h0z"/><path class="cls-1" d="m160.46 29.9V10.8h1.8V30h-1.8v-.1zm8.7-5.8-8.3-12.4.6-.5.7-.5 7.9 11.6-.9 1.8zm0 0-.8-1.8 7.8-11.6.7.5.6.5-8.3 12.4zm7.1 5.8V10.8h1.8V30h-1.8v-.1zm12.4.3c-1.3.0-2.5-.3-3.5-.9s-1.8-1.5-2.4-2.5c-.6-1.1-.9-2.3-.9-3.7s.3-2.6.8-3.7c.6-1.1 1.4-1.9 2.4-2.5s2.2-.9 3.5-.9 2.5.3 3.5.9 1.8 1.5 2.4 2.5c.6 1.1.8 2.3.8 3.7s-.3 2.6-.8 3.7-1.3 1.9-2.4 2.5c-.9.6-2.1.9-3.4.9h0zm0-1.5c1 0 1.9-.2 2.6-.7s1.3-1.1 1.8-2 .6-1.8.6-2.9-.2-2.1-.6-2.9c-.4-.8-1-1.5-1.8-2s-1.6-.7-2.6-.7-1.9.2-2.6.7c-.8.5-1.4 1.1-1.8 2-.4.8-.6 1.8-.6 2.9s.2 2.1.7 2.9c.4.8 1 1.5 1.8 2s1.5.7 2.5.7h0zm15.3 1.5c-1.2.0-2.3-.3-3.2-.9s-1.7-1.5-2.2-2.5c-.5-1.1-.8-2.3-.8-3.7s.3-2.6.8-3.7 1.3-1.9 2.2-2.5 2-.9 3.2-.9 2.2.3 3.1.9c.9.6 1.6 1.5 2.1 2.5.5 1.1.8 2.3.8 3.7s-.3 2.6-.8 3.7-1.2 1.9-2.1 2.5-1.9.9-3.1.9zm.3-1.4c.9.0 1.7-.2 2.3-.7.7-.5 1.2-1.2 1.6-2 .4-.9.6-1.8.6-3 0-1.1-.2-2.1-.6-3s-.9-1.5-1.6-2-1.5-.7-2.4-.7-1.8.2-2.5.7-1.3 1.2-1.7 2c-.4.9-.6 1.8-.6 3 0 1.1.2 2.1.6 3s1 1.5 1.7 2 1.7.7 2.6.7h0zm4.6 1.1-.1-2.5V10.8h1.6V30h-1.5v-.1zm10.3.3c-1 0-1.9-.2-2.7-.5-.7-.3-1.4-.7-1.8-1.2-.5-.5-.8-1-1-1.5l1.5-.5c.3.7.8 1.2 1.5 1.6s1.4.6 2.2.6c1 0 1.8-.2 2.5-.6s1-1 1-1.7-.2-1.2-.7-1.6-1.2-.8-2.2-1l-1.3-.4c-1.2-.3-2.2-.8-2.8-1.4s-1-1.3-1-2.1c0-1.3.4-2.2 1.2-2.9s2.1-1.1 3.8-1.1c.8.0 1.5.1 2.1.3s1.2.6 1.6 1 .8.9 1 1.5l-1.5.6c-.3-.7-.7-1.2-1.3-1.5s-1.3-.4-2.2-.4c-1 0-1.7.2-2.3.6s-.8 1-.8 1.7c0 .4.2.8.7 1.2s1.1.7 2 .9l1.2.3c.9.2 1.7.5 2.3.9s1.1.9 1.5 1.4.5 1.1.5 1.8c0 .8-.2 1.5-.6 2.1s-1 1-1.7 1.4c-.9.4-1.8.5-2.7.5z"/><g><path class="cls-1" d="m33.6 19.52-.02-.22-.03-.47-.06-.45c-.02-.15-.04-.3-.07-.45l-.08-.47c-.02-.08-.04-.17-.06-.26-.05-.21-.09-.42-.16-.63-.14-.52-.33-1.08-.62-1.75-.21-.49-.48-1.01-.85-1.64-.35-.57-.7-1.06-1.06-1.51-.8-.98-1.7-1.83-2.68-2.52-.17-.13-.35-.24-.53-.36-.08-.05-.16-.1-.24-.16-.08-.04-.17-.1-.26-.15-.18-.11-.35-.21-.53-.3-.48-.25-1.01-.49-1.69-.74-.52-.19-1.1-.35-1.77-.5l-.45-.08c-.16-.03-.3-.05-.45-.07l-.46-.06-.46-.03-.23-.02h-.22l-.46-.02h-.46l-.24.02-.22.02-.47.03-.45.06c-.15.02-.3.04-.45.07l-.46.08c-.66.15-1.24.31-1.76.5-.68.25-1.21.49-1.68.74-.19.09-.36.19-.54.3-.09.05-.18.11-.27.16-.07.05-.15.1-.23.15-.18.12-.36.23-.53.36-.99.69-1.89 1.54-2.69 2.52-.36.44-.71.94-1.06 1.51-.37.63-.63 1.15-.84 1.64-.28.67-.48 1.23-.61 1.74-.06.21-.11.42-.16.63-.02.09-.04.18-.06.27l-.08.45c-.03.16-.05.31-.07.45l-.06.47-.03.46-.02.23v.23l-.02.47v.46l.02.23.02.22.03.47.06.46c.02.15.04.29.07.45l.08.46c.02.08.04.17.06.25.05.22.1.43.16.63.14.52.33 1.08.62 1.75.21.49.48 1.01.85 1.64.35.57.7 1.06 1.06 1.51.8.98 1.7 1.83 2.68 2.52.17.13.34.24.52.35.08.05.17.11.25.16.08.04.17.1.26.15.18.11.35.21.53.29.48.26 1.01.49 1.69.74.37.13.72.24 1.07.34v-1.72c-.06-1.04-.58-2.01-1.43-2.66h-.01c-.15-.13-.28-.22-.39-.3-.11-.08-.21-.16-.31-.23l-.06-.05s-.03-.02-.05-.04c-.71-.49-1.37-1.12-1.97-1.85-.25-.31-.51-.68-.78-1.11-.25-.44-.45-.81-.62-1.21-.16-.39-.33-.82-.45-1.27-.04-.13-.07-.27-.1-.41-.02-.08-.03-.16-.05-.23l-.06-.34c-.02-.11-.04-.22-.05-.34l-.04-.32-.02-.35v-.16l-.02-.18v-.33-.35-.17l.02-.18.02-.33.05-.34c.01-.11.03-.23.05-.34l.06-.32c.02-.09.04-.17.06-.25.03-.14.06-.28.11-.42.11-.45.29-.89.44-1.26.18-.43.4-.83.62-1.2.28-.44.53-.79.78-1.11.6-.73 1.26-1.35 1.97-1.85.11-.09.23-.16.35-.24.07-.04.13-.09.2-.13h0v-.01c.07-.04.14-.08.21-.12.12-.07.24-.14.37-.2.42-.23.87-.41 1.22-.54.36-.13.76-.25 1.29-.37l.33-.06c.11-.02.22-.04.34-.05l.32-.04.34-.02h.16l.18-.02h.33.34.17l.18.02.33.02.34.05c.11.01.22.03.34.05l.32.06c.54.12.94.23 1.3.37.35.13.8.31 1.23.54.12.06.24.13.36.2.07.04.14.08.21.12h0v.01c.07.04.13.09.2.13.12.08.24.15.36.25.7.49 1.37 1.12 1.97 1.85.26.32.5.67.78 1.11.22.38.44.78.62 1.21.16.37.33.82.45 1.27.04.13.07.27.1.41.02.08.03.16.05.23l.06.34c.02.11.04.22.05.34l.04.32.02.34v.16l.02.18v.34.35.17l-.02.18-.02.33-.05.34c-.01.11-.03.23-.05.34l-.06.32c-.02.09-.04.17-.06.25-.03.14-.06.28-.11.42-.11.44-.28.87-.44 1.26-.17.4-.37.77-.62 1.2-.27.44-.53.8-.78 1.11-.6.73-1.26 1.35-1.97 1.85-.02.01-.03.03-.06.04l-.05.04c-.1.08-.2.15-.31.23-.11.08-.23.17-.38.29l-.02.02c-.84.65-1.36 1.62-1.43 2.66h0v1.71c.35-.09.7-.2 1.07-.34.67-.25 1.21-.48 1.68-.74.19-.09.36-.19.54-.3.09-.05.18-.11.27-.16.07-.05.15-.1.24-.15.18-.12.35-.23.52-.35.99-.7 1.89-1.54 2.69-2.52.36-.44.71-.94 1.06-1.51.37-.63.63-1.15.84-1.64.28-.67.48-1.23.61-1.74.06-.21.11-.42.16-.64.02-.09.04-.18.06-.26l.08-.45c.03-.16.05-.31.07-.45l.06-.47.03-.46.02-.24v-.22l.02-.47v-.46l-.02-.24z"/><ellipse class="cls-2" cx="20.15" cy="20" rx="5.21" ry="5.17"/><path class="cls-1" d="m20.15 3.65c4.41.0 8.56 1.7 11.68 4.8 3.11 3.09 4.82 7.19 4.82 11.55s-1.71 8.46-4.82 11.55c-3.12 3.09-7.26 4.8-11.68 4.8s-8.56-1.7-11.68-4.8c-3.11-3.09-4.82-7.19-4.82-11.55s1.71-8.46 4.82-11.55c3.12-3.09 7.26-4.8 11.68-4.8m0-3.65C9.02.0.0 8.95.0 20s9.02 20 20.15 20S40.3 31.05 40.3 20 31.28.0 20.15.0h0z"/></g></svg></span><span class="text-uppercase font-weight-bold"></span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link" 
				href="/spotfire-mods/about/" 
				>
				<span>About</span></a>
				
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link active" 
				href="/spotfire-mods/docs/" 
				>
				<span class="active">Working with mods</span></a>
				
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				<span class="nav-link hasChildren">
					<span >API documentation</span>
				</span>
				
				
				<ul class="navbar-subnav top">
					
					<li class="nav-item">
						<span>Action mods</span>

						
						
						<ul class="navbar-subnav">
							
							<li class="nav-item">
								<a class="nav-link" 
								href="/spotfire-mods/api-docs/action-mods/index.html" 
								>
								<span>API documentation</span></a>
									</li>
							
						</ul>
						
		

					</li>
					
					<li class="nav-item">
						<span>Visualization mods</span>

						
						
						<ul class="navbar-subnav">
							
							<li class="nav-item">
								<a class="nav-link" 
								href="/spotfire-mods/overview/" 
								>
								<span>API Overview</span></a>
									</li>
							
							<li class="nav-item">
								<a class="nav-link" 
								href="/spotfire-mods/api-docs/visualization-mods/index.html" 
								>
								<span>API documentation</span></a>
									</li>
							
						</ul>
						
		

					</li>
					
				</ul>
				
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center d-lg-none">
    

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Working with mods</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocs">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsgetting-started" href="/spotfire-mods/docs/getting-started/">Getting started</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Action mods</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocsaction-mods">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsdeveloping-action-mods" href="/spotfire-mods/docs/action-mods/developing-action-mods/">Developing action mods</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/tutorial/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tutorial</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modstutorial">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/snippets/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Snippets</a>
  </li>
  <ul>
    <li class="collapse show" id="spotfire-modsdocsaction-modssnippets">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/using-the-api/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the API</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modsusing-the-api">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsusing-the-apiapi-docs" href="/spotfire-mods/docs/action-mods/using-the-api/api-docs/">Action mods API documentation</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsaction-modsusing-the-apimod-schema" href="/spotfire-mods/docs/action-mods/using-the-api/mod-schema/">Mod Schema</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/action-mods/faq/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">FAQ</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsaction-modsfaq">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Visualization mods</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-mods">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsdeveloping-visualization-mods" href="/spotfire-mods/docs/visualization-mods/developing-visualization-mods/">Developing visualization mods</a>
        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/tutorials/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Tutorials</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modstutorials">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modstutorialsbarchart-googlechart" href="/spotfire-mods/docs/visualization-mods/tutorials/barchart-googlechart/">Create a bar chart using Google Charts</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modstutorialsmod-icons" href="/spotfire-mods/docs/visualization-mods/tutorials/mod-icons/">Create an icon for your visualization mod</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/using-the-api/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Using the API</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modsusing-the-api">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiapi-overview" href="/spotfire-mods/docs/visualization-mods/using-the-api/api-overview/">API overview</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiapi-docs" href="/spotfire-mods/docs/visualization-mods/using-the-api/api-docs/">Visualization mods API documentation</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apimod-data-views" href="/spotfire-mods/docs/visualization-mods/using-the-api/mod-data-views/">Mod data views</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apimod-schema" href="/spotfire-mods/docs/visualization-mods/using-the-api/mod-schema/">Mod schema</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsusing-the-apiworking-with-readables" href="/spotfire-mods/docs/visualization-mods/using-the-api/working-with-readables/">Mod reader</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/spotfire-mods/docs/visualization-mods/faq/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">FAQ</a>
  </li>
  <ul>
    <li class="collapse " id="spotfire-modsdocsvisualization-modsfaq">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-spotfire-modsdocsvisualization-modsgetting-started-11" href="/spotfire-mods/docs/visualization-mods/getting-started-11/">Getting started (before 14.4)</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">












<a href="https://github.com/spotfiresoftware/spotfire-mods/issues/new?title=Snippets" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/spotfiresoftware/spotfire-mods/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>





</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#how-to-use-a-snippet">How to use a snippet</a></li>
    <li><a href="#snippets">Snippets</a>
      <ul>
        <li><a href="#add-a-hierarchy-column">Add a hierarchy column</a></li>
        <li><a href="#add-a-horizontal-bar-chart">Add a horizontal bar chart</a></li>
        <li><a href="#add-a-shapefile-to-the-active-map-chart">Add a shapefile to the active map chart</a></li>
        <li><a href="#embed-all-data-tables-in-the-analysis">Embed all data tables in the analysis</a></li>
        <li><a href="#find-all-columns-that-match-a-predicate">Find all columns that match a predicate</a></li>
        <li><a href="#read-the-values-of-a-column">Read the values of a column</a></li>
        <li><a href="#remove-all-bookmarks-from-the-document">Remove all bookmarks from the document</a></li>
        <li><a href="#remove-unreferenced-filtering-schemes">Remove unreferenced filtering schemes</a></li>
        <li><a href="#remove-unreferenced-markings">Remove unreferenced markings</a></li>
        <li><a href="#replace-a-data-table-with-an-sbdf-file-from-the-library">Replace a data table with an SBDF file from the library</a></li>
        <li><a href="#save-the-analysis-to-the-library">Save the analysis to the library</a></li>
        <li><a href="#set-a-custom-date-format-for-a-column">Set a custom date format for a column</a></li>
        <li><a href="#set-a-document-property">Set a document property</a></li>
        <li><a href="#set-the-colors-of-a-bar-chart">Set the colors of a bar chart</a></li>
        <li><a href="#set-up-a-page-layout-and-rotate-the-visualizations-on-consecutive-runs">Set up a page layout and rotate the visualizations on consecutive runs</a></li>
        <li><a href="#switch-cross-table-axis">Switch cross table axis</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/">Working with mods</a>
</li>




<li class="breadcrumb-item" >
	<a href="/spotfire-mods/docs/action-mods/">Action mods</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/spotfire-mods/docs/action-mods/snippets/">Snippets</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	
	
	
	<p class="-text-secondary pt-3 h6" >Reading time: 14 minutes and 45 seconds.</p>
	<h1>Snippets</h1>
	<div class="lead">Snippets showing what is possible to do with the API.</div>
	
	<h2 id="how-to-use-a-snippet">How to use a snippet</h2>
<p>Each snippet listed below contains three code blocks. The first block shows the command to run to add the script with an ID and a name. For example <code>npx @spotfire/mods-sdk add-script my-snippet-id --name my-snippet-name</code>.
The second block shows the expected entry in the <code>scripts</code> array of the mod manifest. The third block shows the source code of the script.
Test the snippet by adding the entry to your mod manifest, then copy and paste the source code into the script file.
Some snippets use APIs which require your mod to declare additional capabilities.</p>
<h2 id="snippets">Snippets</h2>
<h3 id="add-a-hierarchy-column">Add a hierarchy column</h3>
<p>Adds a hierarchy column created from the column names.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script add-hierarchy-column --name <span style="color:#4e9a06">&#34;Add a hierarchy column&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;add-hierarchy-column&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Add a hierarchy column&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/add-hierarchy-column.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;addHierarchyColumn&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Adds a hierarchy column created from the column names.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;table&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DataTable&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Table which contains the columns and to which the hierarchy column should be added.&#34;</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hierarchyColumnName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The name of the hierarchy column.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;columnNames&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;A comma separated list of column names from which to create a hierarchy column, e.g: &#39;column1,column2,column3&#39;.&#34;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/add-hierarchy-column.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">HierarchyDefinition</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">HierarchyNestingMode</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addHierarchyColumn</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">table</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">columnNames</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">hierarchyColumnName</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">AddHierarchyColumnParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#8f5902;font-style:italic">// Split the input string to get the names of the columns.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">columns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnNames</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;,&#34;</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Create column expressions from the names, e.g. [column1].
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">columnExpressions</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columns</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">map</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnName</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#4e9a06">`[</span><span style="color:#4e9a06">${</span><span style="color:#000">columnName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">]`</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Create a managed array required by the HierarchyDefinition constructor.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">expressions</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">TypedArray</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">String</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">columnExpressions</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Create the definition from the hierarchy column.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">definition</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">HierarchyDefinition</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">HierarchyNestingMode</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Nested</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">expressions</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// Add the column to the table.
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#4e9a06">`Creating a hierarchy column called &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">hierarchyColumnName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; with the expressions &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">columnExpressions</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span>
        <span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddHierarchyColumn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">hierarchyColumnName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">definition</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Creating column failed: </span><span style="color:#4e9a06">${</span><span style="color:#000">e</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">addHierarchyColumn</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="add-a-horizontal-bar-chart">Add a horizontal bar chart</h3>
<p>Adds a bar chart visualization and configures its orientation to be horizontal.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script add-horizontal-bar-chart --name <span style="color:#4e9a06">&#34;Add a horizontal bar chart&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;add-horizontal-bar-chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Add a horizontal bar chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;addHorizontalBarChart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/add-horizontal-bar-chart.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Adds a bar chart visualization and configures its orientation to be horizontal.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/add-horizontal-bar-chart.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">BarChartOrientation</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addHorizontalBarChart</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">AddHorizontalBarChartParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">page</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActivePageReference</span> <span style="color:#ce5c00;font-weight:bold">??</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Pages</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddNew</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">barChart</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddNew</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Auto configure to select axis.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AutoConfigure</span><span style="color:#000;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// Proceed with custom configuration.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Horizontal Bar Chart&#34;</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Orientation</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">BarChartOrientation</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Horizontal</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">addHorizontalBarChart</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="add-a-shapefile-to-the-active-map-chart">Add a shapefile to the active map chart</h3>
<p>Adds a feature layer to the active map chart visualization using a shapefile from the library. Useful when configured as an action trigger on a map chart visualization.
<strong>Requires the following <a href="/spotfire-mods/docs/action-mods/faq/#what-are-capabilities">capabilities</a>:</strong> LibraryRead</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script add-shapefile-to-active-map-chart --name <span style="color:#4e9a06">&#34;Add a shapefile to the active map chart&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;add-shapefile-to-active-map-chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Add a shapefile to the active map chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;addShapefileToActiveMapChart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/add-shapefile-to-active-map-chart.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Adds a feature layer to the active map chart visualization using a shapefile from the library. Useful when configured as an action trigger on a map chart visualization.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;shapeFileLibraryName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The name of the shapefile in the library.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/add-shapefile-to-active-map-chart.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">SbdfLibraryDataSource</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Import</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">VisualTypeIdentifiers</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">MapChart</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">FeatureLayerVisualization</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Maps</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">addShapefileToActiveMapChart</span><span style="color:#000;font-weight:bold">({</span>
    <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">application</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">shapeFileLibraryName</span>
<span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">AddShapefileToActiveMapChartParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">activeVisual</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActiveVisualReference</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">activeVisual</span><span style="color:#ce5c00;font-weight:bold">?</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeId</span> <span style="color:#ce5c00;font-weight:bold">!==</span> <span style="color:#000">VisualTypeIdentifiers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">MapChart2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;The active visualization is not a map chart.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">mapChart</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">activeVisual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">MapChart</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">libraryManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">shapeFiles</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Search</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`type::sbdf </span><span style="color:#4e9a06">${</span><span style="color:#000">shapeFileLibraryName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">));</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">shapeFiles</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">length</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Cannot find shapefile with name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">shapeFileLibraryName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; in the library.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">shapeFileItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">shapeFiles</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">];</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">table</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shapeFileLibraryName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SbdfLibraryDataSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">shapeFileItem</span><span style="color:#000;font-weight:bold">));</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">featureLayer</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">FeatureLayerVisualization</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">mapChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Layers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddNewFeatureLayer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">featureLayer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Configure the layer
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">featureLayer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Title</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">`Feature Layer from &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">shapeFileLibraryName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;`</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">featureLayer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AutoConfigure</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">addShapefileToActiveMapChart</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="embed-all-data-tables-in-the-analysis">Embed all data tables in the analysis</h3>
<p>Updates the save settings of all tables in the analysis to be embedded in the analysis.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script embed-data-tables --name <span style="color:#4e9a06">&#34;Embed all data tables in the analysis&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;embed-data-tables&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Embed all data tables in the analysis&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/embed-data-tables.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;embedDataTables&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Updates the save settings of all tables in the analysis to be embedded in the analysis.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/embed-data-tables.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataTableSaveSettings</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">embedDataTables</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">EmbedDataTablesParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#8f5902;font-style:italic">// Loop through all data tables current in the analysis.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">table</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tables</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// Create save settins with &#39;useLinkedData&#39; disabled.
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">settings</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DataTableSaveSettings</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>

        <span style="color:#8f5902;font-style:italic">// Add the save settings to the active settings of the document.
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SaveSettings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataTableSettings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">settings</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">embedDataTables</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="find-all-columns-that-match-a-predicate">Find all columns that match a predicate</h3>
<p>This snippet shows how to use a predicate callback to find all time columns of a table and prints them to the debug output.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script find-columns-with-predicate --name <span style="color:#4e9a06">&#34;Find all columns that match a predicate&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;find-columns-with-predicate&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Find all columns that match a predicate&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;findColumnsWithPredicate&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/find-columns-with-predicate.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;This snippet shows how to use a predicate callback to find all time columns of a table and prints them to the debug output.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;table&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DataTable&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The data table in which to search for columns.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/find-columns-with-predicate.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataColumn</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">findColumnsWithPredicate</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">table</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">FindColumnsWithPredicateParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Searching for all time columns in table &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">predicate</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Predicate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataColumn</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dc</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">dc</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IsTime</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">columns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FindAll</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">predicate</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">column</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">columns</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Found time column &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">column</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">findColumnsWithPredicate</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="read-the-values-of-a-column">Read the values of a column</h3>
<p>Shows how to read the values of data column.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script read-column-values --name <span style="color:#4e9a06">&#34;Read the values of a column&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;read-column-values&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Read the values of a column&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;readColumnValues&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/read-column-values.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Shows how to read the values of data column.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;table&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DataTable&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The data table to read from.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The name of the column to read from.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/read-column-values.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataValueCursor</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">IndexSet</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataColumn</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">readColumnValues</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">table</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">column</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">ReadColumnValuesParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">dataColumn</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataColumn</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">column</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dataColumn</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Data table &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; contains no column with name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">column</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">rowsToInclude</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">IndexSet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowCount</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">cursor</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataValueCursor</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateFormatted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dataColumn</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">row</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetRows</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowsToInclude</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">cursor</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">rowIndex</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">row</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Index</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">cursor</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CurrentValue</span><span style="color:#000;font-weight:bold">;</span>

        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowIndex</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Row </span><span style="color:#4e9a06">${</span><span style="color:#000">rowIndex</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> = </span><span style="color:#4e9a06">${</span><span style="color:#000">value</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rowIndex</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#8f5902;font-style:italic">// Logging all data would be very performance intensive for large data tables.
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Skipping logging of further rows.&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">readColumnValues</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="remove-all-bookmarks-from-the-document">Remove all bookmarks from the document</h3>
<p>Removes all bookmarks from the document.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script remove-all-bookmarks --name <span style="color:#4e9a06">&#34;Remove all bookmarks from the document&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;remove-all-bookmarks&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Remove all bookmarks from the document&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;removeAllBookmarks&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/remove-all-bookmarks.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Removes all bookmarks from the document.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/remove-all-bookmarks.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">BookmarkManager</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AnalyticItems</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">removeAllBookmarks</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">application</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">RemoveAllBookmarksParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">bookmarkManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">BookmarkManager</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">bookmarkManager</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;BookmarkManager is not available.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">bookmark</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">bookmarkManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetBookmarks</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Removing bookmark with name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">bookmark</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">bookmarkManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Remove</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">bookmark</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">removeAllBookmarks</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="remove-unreferenced-filtering-schemes">Remove unreferenced filtering schemes</h3>
<p>Removes all filtering schemes which are not referenced by a visualization.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script remove-unreferenced-filtering-schemes --name <span style="color:#4e9a06">&#34;Remove unreferenced filtering schemes&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;remove-unreferenced-filtering-schemes&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Remove unreferenced filtering schemes&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;removeUnreferencedFilteringSchemes&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/remove-unreferenced-filtering-schemes.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Removes all filtering schemes which are not referenced by a visualization.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/remove-unreferenced-filtering-schemes.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataFilteringSelection</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">Visualization</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">removeUnreferencedFilteringSchemes</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">RemoveUnreferencedFilteringSchemesParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">referencedFilterings</span>: <span style="color:#204a87;font-weight:bold">Spotfire.Dxp.Data.DataFilteringSelection</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[];</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">page</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Pages</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visual</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visualization</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">visual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Visualization</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">visualization</span><span style="color:#ce5c00;font-weight:bold">?</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">continue</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#000;font-weight:bold">}</span>

            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">visualization</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">UseActiveFiltering</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">referencedFilterings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActiveFilteringSelectionReference</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000;font-weight:bold">}</span>

            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">selection</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">visualization</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Filterings</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">filtering</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">selection</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryCast</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataFilteringSelection</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">filtering</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000">referencedFilterings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filtering</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">unreferencedFilterings</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FilteringSchemes</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span>
        <span style="color:#000">filtering</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">referencedFilterings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">includes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filtering</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FilteringSelectionReference</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">filtering</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">unreferencedFilterings</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Filterings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Remove</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filtering</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FilteringSelectionReference</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">removeUnreferencedFilteringSchemes</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="remove-unreferenced-markings">Remove unreferenced markings</h3>
<p>Removes all markings which are not referenced by a visualization.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script remove-unreferenced-markings --name <span style="color:#4e9a06">&#34;Remove unreferenced markings&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;remove-unreferenced-markings&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Remove unreferenced markings&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;removeUnreferencedMarkings&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/remove-unreferenced-markings.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Removes all markings which are not referenced by a visualization.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/remove-unreferenced-markings.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataMarkingSelection</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">Visualization</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">removeUnreferencedMarkings</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">RemoveUnreferencedMarkingsParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">referencedMarkings</span>: <span style="color:#204a87;font-weight:bold">Spotfire.Dxp.Data.DataMarkingSelection</span><span style="color:#000;font-weight:bold">[]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[];</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">page</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Pages</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visual</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visualization</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">visual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Visualization</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">visualization</span><span style="color:#ce5c00;font-weight:bold">?</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">continue</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#000;font-weight:bold">}</span>

            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">visualization</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">MarkingReference</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">referencedMarkings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">visualization</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">MarkingReference</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000;font-weight:bold">}</span>

            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">selection</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">visualization</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Filterings</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">marking</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">selection</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryCast</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataMarkingSelection</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">marking</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000">referencedMarkings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">push</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">marking</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">unreferencedMarkings</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Markings</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span>
        <span style="color:#000">marking</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">referencedMarkings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">includes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">marking</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">marking</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">unreferencedMarkings</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Markings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Remove</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">marking</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">removeUnreferencedMarkings</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="replace-a-data-table-with-an-sbdf-file-from-the-library">Replace a data table with an SBDF file from the library</h3>
<p>Replaces a table in the analysis with data from an SBDF file saved in the library.
<strong>Requires the following <a href="/spotfire-mods/docs/action-mods/faq/#what-are-capabilities">capabilities</a>:</strong> LibraryRead</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script replace-table-with-library-data --name <span style="color:#4e9a06">&#34;Replace a data table with an SBDF file from the library&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;replace-table-with-library-data&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Replace a data table with an SBDF file from the library&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;replaceTableWithLibraryData&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/replace-table-with-library-data.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Replaces a table in the analysis with data from an SBDF file saved in the library.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;libraryGuid&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The library ID of the SBDF.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;table&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DataTable&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The data table which should be replaced.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/replace-table-with-library-data.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">Guid</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">SbdfLibraryDataSource</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Import</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemType</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">replaceTableWithLibraryData</span><span style="color:#000;font-weight:bold">({</span>
    <span style="color:#000">application</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">libraryGuid</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">table</span>
<span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">ReplaceTableWithLibraryDataParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">manager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">manager</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;LibraryManager is unavailable.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">guid</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Guid</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">Guid</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryParse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">libraryGuid</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">guid</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`The provided library ID &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">libraryGuid</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; is not a valid GUID.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">item</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">manager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">guid</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">item</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`A library item with the id &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">libraryGuid</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; could not be found.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ItemType</span> <span style="color:#ce5c00;font-weight:bold">!==</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SbdfDataFile</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;The library item is not an SBDF file.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">ds</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">SbdfLibraryDataSource</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">item</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ReplaceData</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ds</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Failed to replace table with library data, exception: </span><span style="color:#4e9a06">${</span><span style="color:#000">e</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">replaceTableWithLibraryData</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="save-the-analysis-to-the-library">Save the analysis to the library</h3>
<p>Saves the current analysis to the library.
<strong>Requires the following <a href="/spotfire-mods/docs/action-mods/faq/#what-are-capabilities">capabilities</a>:</strong> LibraryRead, LibraryWrite
<strong>Requires <a href="/spotfire-mods/docs/action-mods/faq/#why-does-my-script-run-inside-a-transaction"><code>wrapInTransaction</code></a> to be <code>false</code>.</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script save-analysis-to-library --name <span style="color:#4e9a06">&#34;Save the analysis to the library&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;save-analysis-to-library&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Save the analysis to the library&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;saveAnalysisToLibrary&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/save-analysis-to-library.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Saves the current analysis to the library.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;wrapInTransaction&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;libraryFolder&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The path to the folder in the library where the analysis should be saved.&#34;</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;title&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The title of the analysis.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/save-analysis-to-library.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemMetadataSettings</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span>
    <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Framework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Library</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DocumentSaveSettings</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">saveAnalysisToLibrary</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">libraryFolder</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">title</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SaveAnalysisToLibraryParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">libraryManager</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetService</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryManager</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">folderItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">getOrCreateLibraryFolder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">libraryFolder</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Saving analysis to &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">joinPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">folderItem</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Path</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">title</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SaveAs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">folderItem</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">title</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">LibraryItemMetadataSettings</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DocumentSaveSettings</span><span style="color:#000;font-weight:bold">());</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * Gets or creates a library folder with the given path. If it does not exist then the folder structure
</span><span style="color:#8f5902;font-style:italic"> * is recursively created by splitting the path on &#34;/&#34;.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">getOrCreateLibraryFolder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">libraryManager</span>: <span style="color:#204a87;font-weight:bold">Spotfire.Dxp.Framework.Library.LibraryManager</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">folderPath</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">folderItem</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>
        <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetItem</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#000">folderPath</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Folder</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">folderItem</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IncludePath</span>
        <span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">parentFolder</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">LibraryItem</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetItem</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Folder</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">parentFolder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Cannot retrieve library root.&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">let</span> <span style="color:#000">parent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">parentFolder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">pathParts</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">folderPath</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">part</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">pathParts</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#8f5902;font-style:italic">// Skip initial &#34;/&#34; root if it exists.
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">part</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#204a87;font-weight:bold">continue</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#000;font-weight:bold">}</span>

            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">joinPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parent</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Path</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">part</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>
                <span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetItem</span><span style="color:#000;font-weight:bold">(</span>
                    <span style="color:#000">path</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#000">LibraryItemType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Folder</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#000">parentFolder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">,</span>
                    <span style="color:#000">LibraryItemRetrievalOption</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IncludePath</span>
                <span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Creating library folder with path &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">path</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;`</span><span style="color:#000;font-weight:bold">);</span>
                <span style="color:#000">parent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">libraryManager</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateFolder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parent</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">part</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">LibraryItemMetadataSettings</span><span style="color:#000;font-weight:bold">());</span>
            <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">folderItem</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">parent</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">folderItem</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">joinPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">left</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">right</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">left</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">concat</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">right</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">)).</span><span style="color:#000">join</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#000">replace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;//&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">saveAnalysisToLibrary</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="set-a-custom-date-format-for-a-column">Set a custom date format for a column</h3>
<p>Sets a custom date format for a specific column.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script set-custom-date-format --name <span style="color:#4e9a06">&#34;Set a custom date format for a column&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;set-custom-date-format&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Set a custom date format for a column&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;setCustomDateFormat&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/set-custom-date-format.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Sets a custom date format for a specific column.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;format&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The date format, e.g. &#39;dd-MM-yyyy&#39; for day/month-year.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;columnName&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The name of the column whose date format should be set.&#34;</span>
        <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;table&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DataTable&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The data table in which the column can be found.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/set-custom-date-format.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataColumn</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DateTimeFormatter</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Formatters</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setCustomDateFormat</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">format</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">columnName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">table</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetCustomDateFormatParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">column</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataColumn</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">columnName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">column</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Table &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; does not contain a column with the name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">columnName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">column</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataType</span> <span style="color:#ce5c00;font-weight:bold">!==</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`The column &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">columnName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; in table &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">table</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; is not a DateTime column.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#8f5902;font-style:italic">// We have to cast here since CreateLocalizedFormatter returns a type which is not specific enough.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">formatter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DateTime</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateLocalizedFormatter</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Cast</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DateTimeFormatter</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FormatString</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">format</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">column</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Formatter</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">formatter</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setCustomDateFormat</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="set-a-document-property">Set a document property</h3>
<p>Sets a document property to a specific value, creating the property if it does not already exist.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script set-document-property --name <span style="color:#4e9a06">&#34;Set a document property&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;set-document-property&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Set a document property&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;setDocumentProperty&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/set-document-property.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Sets a document property to a specific value, creating the property if it does not already exist.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;propertyName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The name of the property.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The type of the property.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The value to set the document property to.&#34;</span> <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/set-document-property.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">setDocumentProperty</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propertyName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">value</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SetDocumentPropertyParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">dataType</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FromName</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">typedValue</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87">Object</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">dataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryParse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">typedValue</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">properties</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propertyName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">propertyName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000">properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span>
                <span style="color:#4e9a06">`Document property with name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">propertyName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; does not exist. Creating it with type &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">dataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span>
            <span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#000">console</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Setting value of &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">propertyName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; to &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">dataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Formatter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">typedValue</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">typedValue</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Failed to parse &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">value</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39; as type &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">dataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">setDocumentProperty</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="set-the-colors-of-a-bar-chart">Set the colors of a bar chart</h3>
<p>Updates the categorical coloring of a bar chart visualization.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script bar-chart-coloring --name <span style="color:#4e9a06">&#34;Set the colors of a bar chart&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;bar-chart-coloring&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Set the colors of a bar chart&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;barChartColoring&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/bar-chart-coloring.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Updates the categorical coloring of a bar chart visualization.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
        <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;visual&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Visualization&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The bar chart visualization.&#34;</span> <span style="color:#000;font-weight:bold">},</span>
        <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;colorMap&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;String&#34;</span><span style="color:#000;font-weight:bold">,</span>
            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;A comma separated list of key=color combinators, e.g. \&#34;Apple=red,Banana=yellow\&#34;.&#34;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/bar-chart-coloring.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">CategoryKey</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">AxisMode</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">Color</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">System</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Drawing</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">red</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Color</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FromArgb</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">blue</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Color</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FromArgb</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">green</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Color</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FromArgb</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">yellow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Color</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FromArgb</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">255</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">toColor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span>: <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">toLowerCase</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#4e9a06">&#34;red&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">red</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#4e9a06">&#34;blue&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">blue</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#4e9a06">&#34;green&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">green</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#4e9a06">&#34;yellow&#34;</span><span style="color:#ce5c00;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">yellow</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">default</span><span style="color:#ce5c00;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Unknown color name &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">barChartColoring</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">visual</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">colorMap</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">BarChartColoringParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">barChart</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">visual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">BarChart</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`The visual provided is not a bar chart visualization.`</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColorAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Coloring</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Clear</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">keyColor</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">colorMap</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;,&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">keyColor</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">includes</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;=&#34;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Broken key=color pair: &#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">keyColor</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;.`</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">color</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">keyColor</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;=&#34;</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000">barChart</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColorAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Coloring</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">SetColorForCategory</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">CategoryKey</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">toColor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">color</span><span style="color:#000;font-weight:bold">));</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">barChartColoring</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="set-up-a-page-layout-and-rotate-the-visualizations-on-consecutive-runs">Set up a page layout and rotate the visualizations on consecutive runs</h3>
<p>Creates a layout where one visualization is enlarged and all others are stacked to its the right. On consecutive runs the enlarged visualization is rotated with one of the smaller ones.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script layout-and-rotate --name <span style="color:#4e9a06">&#34;Set up a page layout and rotate the visualizations on consecutive runs&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;layout-and-rotate&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Set up a page layout and rotate the visualizations on consecutive runs&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;layoutAndRotate&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/layout-and-rotate.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Creates a layout where one visualization is enlarged and all others are stacked to its the right. On consecutive runs the enlarged visualization is rotated with one of the smaller ones.&#34;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/layout-and-rotate.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataPropertyAttributes</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">LayoutDefinition</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Layout</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">layoutAndRotate</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#204a87">document</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">LayoutAndRotateParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActivePageReference</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;No active page open.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">page</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ActivePageReference</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visuals</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#204a87;font-weight:bold">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">length</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;No or too few visualizations on the current page to properly layout.&#34;</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#8f5902;font-style:italic">// Find out what index was used last rotation and increment it.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">indexProperty</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">getIndexProperty</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">nextIndex</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">indexProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#000">visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">largeVisual</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">visuals</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">nextIndex</span><span style="color:#000;font-weight:bold">];</span>

    <span style="color:#8f5902;font-style:italic">// Store the index for next run.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">indexProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">nextIndex</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">layout</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">LayoutDefinition</span><span style="color:#000;font-weight:bold">();</span>
    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">BeginSideBySideSection</span><span style="color:#000;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// Stack with a single visualization to be able to define proportion.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">BeginStackedSection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">70</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">largeVisual</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">EndSection</span><span style="color:#000;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// Second section containing all other visualizations stacked.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">BeginStackedSection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">30</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">visual</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">visuals</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">filter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">v</span> <span style="color:#ce5c00;font-weight:bold">=&gt;</span> <span style="color:#000">v</span> <span style="color:#ce5c00;font-weight:bold">!==</span> <span style="color:#000">largeVisual</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">visual</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">EndSection</span><span style="color:#000;font-weight:bold">();</span>

    <span style="color:#000">layout</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">EndSection</span><span style="color:#000;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// Apply the layout
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">page</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ApplyLayout</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">layout</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic">     * Gets the index of the visualization which was enlarged the last time this script ran.
</span><span style="color:#8f5902;font-style:italic">     * @returns A property containing the index of the visualization which is currently enlarged.
</span><span style="color:#8f5902;font-style:italic">     */</span>
    <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">getIndexProperty</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DataProperty</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#204a87;font-weight:bold">get</span> <span style="color:#000">Value</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">number</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">propertyName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;script.layout.index&#34;</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">property</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">OutParam</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TryGetProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">propertyName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">out</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#8f5902;font-style:italic">// Hide the document property in the UI.
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">attributes</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DefaultAttributes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Xor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyAttributes</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">IsVisible</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DataProperty</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCustomPrototype</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">propertyName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Integer</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attributes</span><span style="color:#000;font-weight:bold">);</span>
            <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Data</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Properties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">AddProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataPropertyClass</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Document</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">propertyValue</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">property</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#8f5902;font-style:italic">// Validate that the property is of the correct type.
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">typeof</span> <span style="color:#000">propertyValue</span> <span style="color:#ce5c00;font-weight:bold">!==</span> <span style="color:#4e9a06">&#34;number&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">`Property </span><span style="color:#4e9a06">${</span><span style="color:#000">propertyName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06"> has unexpected type.`</span><span style="color:#000;font-weight:bold">);</span>
        <span style="color:#000;font-weight:bold">}</span>

        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">propertyValue</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">layoutAndRotate</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><h3 id="switch-cross-table-axis">Switch cross table axis</h3>
<p>Switches the axis expressions of a cross table visualization.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">npx @spotfire/mods-sdk add-script switch-cross-table-axis --name <span style="color:#4e9a06">&#34;Switch cross table axis&#34;</span>
</code></pre></div><p><strong>mod-manifest.json:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;switch-cross-table-axis&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Switch cross table axis&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;entryPoint&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;switchCrossTableAxis&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;file&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;build/switch-cross-table-axis.js&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Switches the axis expressions of a cross table visualization.&#34;</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[{</span> <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;visual&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Visualization&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The cross table visualization.&#34;</span> <span style="color:#000;font-weight:bold">}]</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><strong>src/scripts/switch-cross-table-axis.ts:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ts" data-lang="ts"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">CrossTablePlot</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Spotfire</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Dxp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Visuals</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#204a87;font-weight:bold">export</span> <span style="color:#204a87;font-weight:bold">function</span> <span style="color:#000">switchCrossTableAxis</span><span style="color:#000;font-weight:bold">({</span> <span style="color:#000">visual</span> <span style="color:#000;font-weight:bold">}</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">SwitchCrossTableAxisParameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">crossTable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">visual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">As</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">CrossTablePlot</span><span style="color:#000;font-weight:bold">);</span>

    <span style="color:#8f5902;font-style:italic">// Throw an informative error if the user hasn&#39;t provided a visualization which is a cross table.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">crossTable</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#204a87;font-weight:bold">throw</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#204a87">Error</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#4e9a06">`The visual provided is not a cross table, visualization type is: </span><span style="color:#4e9a06">${</span><span style="color:#000">visual</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TypeId</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DisplayName</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">.`</span>
        <span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#8f5902;font-style:italic">// Store the current expressions in local variables.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">columnAxisExpression</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">crossTable</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColumnAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">rowAxisExpression</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">crossTable</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">// Swap them.
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">crossTable</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColumnAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">rowAxisExpression</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">crossTable</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowAxis</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Expression</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">columnAxisExpression</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000">RegisterEntryPoint</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">switchCrossTableAxis</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div>
        






	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified June 5, 2024
</div>
</div>

          </main>
        </div>
      </div>
      
<footer class="bg-dark py-4 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the official Spotfire page on X" aria-label="Open the official Spotfire page on X">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://x.com/spotfire">
      <i class="fab fa-x-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the official Spotfire page on LinkedIn" aria-label="Open the official Spotfire page on LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/company/spotfire/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Dr. Spotfire YouTube channel" aria-label="Open the Dr. Spotfire YouTube channel">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/@drspotfire">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Facebook group for Spotfire users, partners, and practitioners" aria-label="Open the Facebook group for Spotfire users, partners, and practitioners">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/groups/651751391967838">
      <i class="fab fa-facebook"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Open the Spotfire user group on LinkedIn" aria-label="Open the Spotfire user group on LinkedIn">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/groups/12253057/">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/spotfiresoftware/spotfire-mods">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="TIBCO Community" aria-label="TIBCO Community">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://spotfi.re/community/mods-overview">
      <i class="fa fa-comment-alt"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2024 Cloud Software Group All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.cloud.com/privacy-policy" target="_blank">Privacy Policy</a></small>
	
		<p class="mt-2"><a href="/spotfire-mods/about/">About Spotfire Mods</a></p>
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/spotfire-mods/js/main.min.fc448b19813d4fadb2cca28987d991692426ee27f66ce87690830854284c14ec.js" data-integrity="sha256-/ESLGYE9T62yzKKJh9mRaSQm7if2bOh2kIMIVChMFOw=" crossorigin="anonymous"></script>




  </body>
</html>